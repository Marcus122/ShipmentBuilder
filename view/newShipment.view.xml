<mvc:View xmlns:cc="cc.control" xmlns:l="sap.ui.layout" xmlns:core="sap.ui.core" xmlns:sb="sb.control" xmlns:f="sap.ui.layout.form"
	xmlns:comm="sap.ui.commons" xmlns:mvc="sap.ui.core.mvc" xmlns="sap.m" controllerName="sb.controller.newShipment">
    <Panel class="sapUiMediumMarginBottom new-panel">
        <headerToolbar>
            <Toolbar design="Solid" class="dropdownToolbar">
                <Title text="Create New Shipment" titleStyle="H3"/>
                <ToolbarSpacer/>
                <Button icon="sap-icon://navigation-up-arrow" type="Transparent" press="toggleBox"/>
            </Toolbar>
        </headerToolbar>
        <content>
            <sb:div>
                <sb:div id="new-shipment-data">
                    <sb:div>
                        <f:Form
                            maxContainerCols="2"
                            editable="true">
                            <f:layout>
                                <f:ResponsiveGridLayout
                                    labelSpanL="4"
                                    labelSpanM="4"
                                    emptySpanL="2"
                                    emptySpanM="2"
                                    columnsL="3"
                                    columnsM="3" />
                            </f:layout>
                            <f:formContainers>
                                <f:FormContainer>
                                    <f:FormElement label="Ref no">
                                            <Input value="{NewShipment>/ShipmentNum}"/>
                                    </f:FormElement>
                                  </f:FormContainer>
                                  <f:FormContainer>
                                    <f:FormElement label="Shipping Point">
                                        <Input value="{NewShipment>/PlanningPoint}" showValueHelp="true" valueHelpRequest="shippingPointHelp"/>
                                    </f:FormElement>
                                </f:FormContainer>
                                <f:FormContainer>
                                    <f:FormElement label="End Point">
                                        <Input value="{NewShipment>/EndPoint}" showValueHelp="true" valueHelpRequest="shippingPointHelp"/>
                                    </f:FormElement>
                                </f:FormContainer>
                            </f:formContainers>
                        </f:Form>
                        <f:Form
                            maxContainerCols="2"
                            editable="true">
                            <f:layout>
                                <f:ResponsiveGridLayout
                                    labelSpanL="6"
                                    labelSpanM="6"
                                    columnsL="4"
                                    columnsM="4" />
                            </f:layout>
                            <f:formContainers>
                                <f:FormContainer>
                                    <f:FormElement label="Start date">
                                        <DatePicker displayFormat="dd/MM/yyyy" dateValue="{NewShipment>/StartDate}"/>
                                    </f:FormElement>
                                    <f:FormElement label="Start Time">
                                        <HBox>
                                            <TimePicker valueFormat="HH:mm" displayFormat="HH:mm" dateValue="{NewShipment>/StartTime}" change="setStartTime"/>
                                            <Button icon="sap-icon://history" press="calcStartTime"/>
                                        </HBox>
                                    </f:FormElement>
                                </f:FormContainer>
                                <f:FormContainer>
                                    <f:FormElement label="End Date">
                                        <DatePicker displayFormat="dd/MM/yyyy" dateValue="{NewShipment>/EndDate}"/>
                                    </f:FormElement>
                                    <f:FormElement label="End Time">
                                        <HBox>
                                            <TimePicker valueFormat="HH:mm" displayFormat="HH:mm" dateValue="{NewShipment>/EndTime}"/>
                                            <Button icon="sap-icon://history" press="calcEndTime"/>
                                        </HBox>
                                    </f:FormElement>
                                </f:FormContainer>
                                <f:FormContainer>
                                    <f:FormElement label="Travel Time">
                                        <Input enabled="false" value="{NewShipment>/TavelTime}"/>
                                    </f:FormElement>
                                    <f:FormElement label="Travel Distance">
                                        <Input enabled="false" value="{NewShipment>/TavelDistance}"/>
                                    </f:FormElement>
                                </f:FormContainer>
                                <f:FormContainer>
                                    <f:FormElement label="Total Kg">
                                        <Input enabled="false" value="{NewShipment>/Kg}"/>
                                    </f:FormElement>
                                    <f:FormElement label="Total Vol">
                                        <Input enabled="false" value="{NewShipment>/Vol}"/>
                                    </f:FormElement>
                                </f:FormContainer>
                            </f:formContainers>
                        </f:Form>
                    </sb:div>
                    <sb:dragDropTable change="reorder" dropFrom="fixed-orders,open-orders">
                        <Table selectionChange="selectionChange" mode="MultiSelect" rememberSelections="false" class="sapUiSmallMarginTopBottom fixed-sort open-sort backload-sort order-table" items="{NewShipment>/Orders}" showNoData="false" id="new-shipment">
                            <columns>
                                <Column width="30px">
                                    <Text text="Drop"/>
                                </Column>
                                <Column width="50px">
                                    <Text text="Cust"/>
                                </Column>
                                <Column>
                                    <Text text="Sold To PO"/>
                                </Column>
                                <Column>
                                    <Text text="Ship To"/>
                                </Column>
                                <Column>
                                    <Text text="Ship To PO"/>
                                </Column>
                                <Column>
                                    <Text text="Town"/>
                                </Column>
                                <Column>
                                    <Text text="Postcode"/>
                                </Column>
                                <Column width="40px">
                                    <Text text="Vol"/>
                                </Column>
                                <Column width="40px">
                                    <Text text="Kg"/>
                                </Column>
                                <Column styleClass="order-change">
                                    <Text text="Bkd date"/>
                                </Column>
                                <Column styleClass="order-change">
                                    <Text text="Bkd time"/>
                                </Column>
                                <Column>
                                    <Text text="Actual time"/>
                                </Column>
                                <Column styleClass="order-change">
                                    <Text text="Bkd Ref"/>
                                </Column>
                                <Column width="40px">
                                    <Text text="Distance"/>
                                </Column>
                                <Column>
                                    <Text text="Travel time"/>
                                </Column>
                                <Column width="40px">
                                    <Text text="Tip time"/>
                                </Column>
                                <Column styleClass="order-change">
                                </Column>
                            </columns>
                            <items>
                                <ColumnListItem press="calculateDistances" type="Active" selected="{NewShipment>Order/Edit}">
                                    <customData>
                                        <core:CustomData key="selected" value="{parts:[{path:'DistanceCalculated>/Postcode'},{path:'NewShipment>Order/Postcode'}],formatter:'.isSelected'}" writeToDom="true" />
                                    </customData>
                                    <Text text="{NewShipment>DropNumber}"/>
                                    <Text text="{NewShipment>Order/SoldTo}"/>
                                    <Link text="{NewShipment>Order/SoldToPO}" press="viewOrderDetails"/>
                                    <Text text="{NewShipment>Order/ShipTo}"/>
                                    <Text text="{NewShipment>Order/ShipToPO}"/>
                                    <Text text="{NewShipment>Order/ShipToAddr/City}"/>
                                    <Text text="{NewShipment>Order/Postcode}"/>
                                    <Text text="{NewShipment>Order/Volume}"/>
                                    <Text text="{NewShipment>Order/Weight}"/>
                                     <sb:div>
                                        <Text text="{path:'NewShipment>Order/FixedDateTime',formatter:'.formatter.writeDate'}" visible="{= ${NewShipment>Order/Edit} ? false : true }"/>
                                        <DatePicker width="125px" displayFormat="dd.MM.yyyy" dateValue="{NewShipment>Order/EditFields/FixedDateTime}" visible="{= ${NewShipment>Order/Edit} ? true : false }" change="changeFixedDate"/>
                                    </sb:div>
                                    <sb:div>
                                        <Text text="{path:'NewShipment>Order/FixedDateTime',formatter:'.formatter.writeTime'}" visible="{= ${NewShipment>Order/Edit} ? false : true }"/>
                                        <TimePicker width="100px" displayFormat="HH:mm" value="{NewShipment>Order/EditFields/FixedTime}" visible="{= ${NewShipment>Order/Edit} ? true : false }" change="changeFixedTime"/>
                                    </sb:div>
                                    <Text text="{path:'NewShipment>ActualTime',formatter:'.formatter.writeTime'}"/>
                                    <sb:div>
                                        <Text text="{NewShipment>Order/CustRef}" visible="{= ${NewShipment>Order/Edit} ? false : true }"/>
                                        <Input width="125px" value="{NewShipment>Order/EditFields/CustRef}" visible="{= ${NewShipment>Order/Edit} ? true : false }" change="changeCustRef"/>
                                    </sb:div>
                                    <Text text="{NewShipment>Distance}"/>
                                    <Text text="{NewShipment>Time}"/>
                                    <Text text="{NewShipment>TipTime}"/>
                                    <sb:div>
                                        <core:Icon src="sap-icon://delete" press="remove" visible="{= ${NewShipment>Order/Edit} ? false : true }"/>
                                        <Button visible="{= ${NewShipment>Order/Edit} ? true : false }" icon="sap-icon://save" press="saveOrder"/>
                                    </sb:div>
                                </ColumnListItem>
                            </items>
                        </Table>
                    </sb:dragDropTable>
                    <Toolbar class="sb-button-toolbar">
                        <Button id="show-new-map" visible="false" text="View map" icon="sap-icon://map" type="Transparent" press="viewMap"/>
                        <ToolbarSpacer/>
                        <Button text="Cancel" press="cancel"/>
                        <Button text="Save" type="Emphasized" icon="sap-icon://save" press="save"/>
                    </Toolbar>
                    <sb:div id="new-map" class="sapUiSmallMarginTop" visible="false"/>
                 </sb:div>
            </sb:div>
        </content>
    </Panel>
</mvc:View>