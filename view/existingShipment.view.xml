<mvc:View xmlns:cc="cc.control" xmlns:l="sap.ui.layout" xmlns:core="sap.ui.core" xmlns:sb="sb.control" xmlns:f="sap.ui.layout.form"
	xmlns:comm="sap.ui.commons" xmlns:mvc="sap.ui.core.mvc" xmlns="sap.m" controllerName="sb.controller.existingShipment">
    <Panel class="sapUiMediumMarginBottom existing-panel">
        <headerToolbar>
            <Toolbar design="Solid" class="dropdownToolbar">
                <Title text="Existing Shipments" titleStyle="H3"/>
                <ToolbarSpacer/>
                <Button icon="sap-icon://navigation-up-arrow" type="Transparent" press="toggleBox"/>
            </Toolbar>
        </headerToolbar>
        <content>
            <sb:div id="existing-shipment-area">
                <sb:div class="sb-filter-bar">
                    <Toolbar design="Transparent">
                        <ToolbarSpacer/>
                        <Link text="Hide Filter Bar" target="existing-filter" press="hideFilterBar"/>
                    </Toolbar>
                    <l:Grid id="existing-filter" defaultSpan="XL3 L4 M4 S6" class="filter-content">
                        <VBox>
                            <Text text="Shipment created date"/>
                            <DatePicker displayFormat="dd/MM/yyyy"/>
                        </VBox>
                        <VBox>
                            <Text text="Shipment created by"/>
                            <Input/>
                        </VBox>
                        <VBox>
                            <Text text="First drop date"/>
                            <DatePicker displayFormat="dd/MM/yyyy"/>
                        </VBox>
                        <VBox>
                            <Text text=""/>
                            <Button text="Search" icon="sap-icon://search"/>
                        </VBox>
                    </l:Grid>
                    <Table items="{ExistingShipments>/}" class="sortable-table" itemPress="selectExisting" noDataText="No Shipments">
                        <columns>
                            <Column>
                                <Link text="Shipment number" press="sort" target="ShipmentNum"/>
                            </Column>
                            <Column>
                                <Link text="Start Date" press="sort" target="StartDateTime"/>
                            </Column>
                            <Column>
                                <Link text="Shipping Point" press="sort" target="PlanningPoint"/>
                            </Column>
                            <Column>
                                <Link text="1st Drop town" press="sort" target="FirstDropTown"/>
                            </Column>
                            <Column>
                                <Link text="Travel distance" press="sort" target="TravelDistance"/>
                            </Column>
                             <Column>
                                <Link text="Travel time" press="sort" target="TravelTime"/>
                            </Column>
                            <Column>
                                <Link text="Status" press="sort" target="Status"/>
                            </Column>
                        </columns>
                        <items>
                            <ColumnListItem type="Navigation">
                                <Text text="{ExistingShipments>ShipmentNum}"/>
                                <Text text="{path:'ExistingShipments>StartDateTime',formatter:'.formatter.writeDate'}"/>
                                <Text text="{ExistingShipments>PlanningPoint}"/>
                                <Text text="{ExistingShipments>FirstDropTown}"/>
                                <Text text="{ExistingShipments>TravelDistance}"/>
                                <Text text="{ExistingShipments>TravelTime}"/>
                                <Text text="{ExistingShipments>Status}"/>
                            </ColumnListItem>
                        </items>
                    </Table>
                </sb:div>
                <sb:div id="existing-shipment-data" visible="{path:'ExistingShipment>/',formatter:'.isShipmentSelected'}" class="sapUiMediumMarginTop">
                    <Title text="Existing Shipments - Details" titleStyle="H3"/>
                    <sb:div>
                        <f:Form
                            maxContainerCols="2"
                            editable="true">
                            <f:layout>
                                <f:ResponsiveGridLayout
                                    labelSpanL="4"
                                    labelSpanM="4"
                                    emptySpanL="2"
                                    emptySpanM="2"
                                    columnsL="3"
                                    columnsM="3" />
                            </f:layout>
                            <f:formContainers>
                                <f:FormContainer>
                                    <f:FormElement label="Ref no">
                                        <Input value="{ExistingShipment>/ShipmentNum}" enabled="false"/>
                                    </f:FormElement>
                                </f:FormContainer>
                                <f:FormContainer>
                                    <f:FormElement label="Shipping Point">
                                        <Input value="{ExistingShipment>/PlanningPoint}" enabled="false"/>
                                    </f:FormElement>
                                </f:FormContainer>
                                <f:FormContainer>
                                    <f:FormElement label="EndPoint">
                                        <Input value="{ExistingShipment>/EndPoint}" enabled="false"/>
                                    </f:FormElement>
                                </f:FormContainer>
                            </f:formContainers>
                        </f:Form>
                        <f:Form
                            maxContainerCols="2"
                            editable="false">
                            <f:layout>
                                <f:ResponsiveGridLayout
                                    labelSpanL="6"
                                    labelSpanM="6"
                                    columnsL="4"
                                    columnsM="4" />
                            </f:layout>
                            <f:formContainers>
                                <f:FormContainer>
                                    <f:FormElement label="Start date">
                                        <Text text="{path:'ExistingShipment>/StartDateTime',formatter:'.formatter.writeDate'}"/>
                                    </f:FormElement>
                                    <f:FormElement label="Start Time">
                                        <Text text="{path:'ExistingShipment>/StartDateTime',formatter:'.formatter.writeTime'}"/>
                                    </f:FormElement>
                                </f:FormContainer>
                                <f:FormContainer>
                                    <f:FormElement label="End Date">
                                        <Text text="{path:'ExistingShipment>/EndDateTime',formatter:'.formatter.writeDate'}"/>
                                    </f:FormElement>
                                    <f:FormElement label="End Time">
                                        <Text text="{path:'ExistingShipment>/EndDateTime',formatter:'.formatter.writeTime'}"/>
                                    </f:FormElement>
                                </f:FormContainer>
                                <f:FormContainer>
                                    <f:FormElement label="Travel Time">
                                        <Text text="{ExistingShipment>/TravelTime}"/>
                                    </f:FormElement>
                                    <f:FormElement label="Travel Distance">
                                        <Text text="{ExistingShipment>/TravelDistance}"/>
                                    </f:FormElement>
                                </f:FormContainer>
                                <f:FormContainer>
                                    <f:FormElement label="Total Kg">
                                        <Text text="{ExistingShipment>/Kg}"/>
                                    </f:FormElement>
                                    <f:FormElement label="Total Vol">
                                        <Text text="{ExistingShipment>/Vol}"/>
                                    </f:FormElement>
                                </f:FormContainer>
                            </f:formContainers>
                        </f:Form>
                        <!--<l:Grid defaultSpan="XL3 L4 M4 S6">
                            <HBox>
                                <Text text="Start date" class="sapUiSmallMarginEnd"/>
                                <Label text="{ExistingShipment>/StartDate}"/>
                            </HBox>
                            <HBox>
                                <Text text="End date" class="sapUiSmallMarginEnd"/>
                                <Label text="{ExistingShipment>/EndDate}"/>
                            </HBox>
                            <HBox>
                                <Text text="Travel time" class="sapUiSmallMarginEnd"/>
                                <Label text="{ExistingShipment>/Time}"/>
                            </HBox>
                        </l:Grid>
                        <l:Grid defaultSpan="XL3 L4 M4 S6">
                            <HBox>
                                <Text text="Start time" class="sapUiSmallMarginEnd"/>
                                <Label text="{ExistingShipment>/StartTime}"/>
                            </HBox>
                            <HBox>
                                <Text text="End time" class="sapUiSmallMarginEnd"/>
                                <Label text="{ExistingShipment>/EndTime}"/>
                            </HBox>
                            <HBox>
                                <Text text="Travel distance" class="sapUiSmallMarginEnd"/>
                                <Label text="{ExistingShipment>/Distance}"/>
                            </HBox>
                        </l:Grid>
                        <l:Grid defaultSpan="XL3 L4 M4 S6">
                            <HBox>
                                <Text text="Shipping Point" class="sapUiSmallMarginEnd"/>
                                <Label text="Wardle"/>
                            </HBox>
                        </l:Grid>-->
                    </sb:div>
                    <sb:dragDropTable change="reorder" dropFrom="fixed-orders,open-orders">
                        <Table selectionChange="selectionChange" mode="MultiSelect" rememberSelections="false" class="sapUiSmallMarginTopBottom fixed-sort open-sort backload-sort" items="{ExistingShipment>/Orders}" showNoData="false" id="existing-shipment">
                            <columns>
                                <Column width="30px">
                                    <Text text="Drop"/>
                                </Column>
                                <Column width="50px">
                                    <Text text="Cust"/>
                                </Column>
                                <Column>
                                    <Text text="Sold To PO"/>
                                </Column>
                                <Column>
                                    <Text text="Ship To"/>
                                </Column>
                                <Column>
                                    <Text text="Ship To PO"/>
                                </Column>
                                <Column>
                                    <Text text="Town"/>
                                </Column>
                                <Column>
                                    <Text text="Postcode"/>
                                </Column>
                                <Column width="40px">
                                    <Text text="Vol"/>
                                </Column>
                                <Column width="40px">
                                    <Text text="Kg"/>
                                </Column>
                                <Column styleClass="order-change">
                                    <Text text="Bkd date"/>
                                </Column>
                                <Column styleClass="order-change">
                                    <Text text="Bkd time"/>
                                </Column>
                                <Column>
                                    <Text text="Actual time"/>
                                </Column>
                                <Column styleClass="order-change">
                                    <Text text="Bkd Ref"/>
                                </Column>
                                <Column width="40px">
                                    <Text text="Distance"/>
                                </Column>
                                <Column>
                                    <Text text="Travel time"/>
                                </Column>
                                <Column width="40px">
                                    <Text text="Tip time"/>
                                </Column>
                                <Column styleClass="order-change">
                                </Column>
                            </columns>
                            <items>
                                <ColumnListItem press="calculateDistances" type="Active" selected="{ExistingShipment>Order/Edit}">
                                    <customData>
                                        <core:CustomData key="selected" value="{parts:[{path:'DistanceCalculated>/Postcode'},{path:'ExistingShipment>Order/Postcode'}],formatter:'.isSelected'}" writeToDom="true" />
                                    </customData>
                                    <Text text="{ExistingShipment>DropNumber}"/>
                                    <Text text="{ExistingShipment>Order/SoldTo}"/>
                                    <Link text="{ExistingShipment>Order/SoldToPO}" press="viewOrderDetails"/>
                                    <Text text="{ExistingShipment>Order/ShipTo}"/>
                                    <Text text="{ExistingShipment>Order/ShipToPO}"/>
                                    <Text text="{ExistingShipment>Order/ShipToAddr/City}"/>
                                    <Text text="{ExistingShipment>Order/Postcode}"/>
                                    <Text text="{ExistingShipment>Order/Volume}"/>
                                    <Text text="{ExistingShipment>Order/Weight}"/>
                                     <sb:div>
                                        <Text text="{path:'ExistingShipment>Order/FixedDateTime',formatter:'.formatter.writeDate'}" visible="{= ${ExistingShipment>Order/Edit} ? false : true }"/>
                                        <DatePicker width="125px" displayFormat="dd.MM.yyyy" dateValue="{ExistingShipment>Order/EditFields/FixedDateTime}" visible="{= ${ExistingShipment>Order/Edit} ? true : false }" change="changeFixedDate"/>
                                    </sb:div>
                                    <sb:div>
                                        <Text text="{path:'ExistingShipment>Order/FixedDateTime',formatter:'.formatter.writeTime'}" visible="{= ${ExistingShipment>Order/Edit} ? false : true }"/>
                                        <TimePicker width="100px" displayFormat="HH:mm" value="{ExistingShipment>Order/EditFields/FixedTime}" visible="{= ${ExistingShipment>Order/Edit} ? true : false }" change="changeFixedTime"/>
                                    </sb:div>
                                    <Text text="{path:'ExistingShipment>ActualTime',formatter:'.formatter.writeTime'}"/>
                                    <sb:div>
                                        <Text text="{ExistingShipment>Order/CustRef}" visible="{= ${ExistingShipment>Order/Edit} ? false : true }"/>
                                        <Input width="125px" value="{ExistingShipment>Order/EditFields/CustRef}" visible="{= ${ExistingShipment>Order/Edit} ? true : false }" change="changeCustRef"/>
                                    </sb:div>
                                    <Text text="{ExistingShipment>Distance}"/>
                                    <Text text="{ExistingShipment>Time}"/>
                                    <Text text="{ExistingShipment>TipTime}"/>
                                    <sb:div>
                                        <core:Icon src="sap-icon://delete" press="remove" visible="{= ${ExistingShipment>Order/Edit} ? false : true }"/>
                                        <Button visible="{= ${ExistingShipment>Order/Edit} ? true : false }" icon="sap-icon://save" press="saveOrder"/>
                                    </sb:div>
                                </ColumnListItem>
                            </items>
                            <!--<columns>
                                <Column>
                                    <Text text="Drop"/>
                                </Column>
                                <Column>
                                    <Text text="Cust"/>
                                </Column>
                                <Column>
                                    <Text text="PO"/>
                                </Column>
                                <Column>
                                    <Text text="O/Type"/>
                                </Column>
                                <Column>
                                    <Text text="Name"/>
                                </Column>
                                <Column>
                                    <Text text="Town"/>
                                </Column>
                                <Column>
                                    <Text text="Postcode"/>
                                </Column>
                                <Column width="28px">
                                    <Text text="Vol"/>
                                </Column>
                                <Column>
                                    <Text text="Kg"/>
                                </Column>
                                <Column>
                                    <Text text="Bkd date"/>
                                </Column>
                                <Column>
                                    <Text text="Bkd time"/>
                                </Column>
                                <Column>
                                    <Text text="Bkd Ref"/>
                                </Column>
                                <Column>
                                    <Text text="Distance"/>
                                </Column>
                                <Column>
                                    <Text text="Travel time"/>
                                </Column>
                                <Column>
                                    <Text text="Tip time"/>
                                </Column>
                                <Column>
                                </Column>
                            </columns>
                            <items>
                                <ColumnListItem press="calculateDistances" type="Active">
                                    <customData>
                                        <core:CustomData key="selected" value="{parts:[{path:'DistanceCalculated>/Postcode'},{path:'ExistingShipment>Order/Postcode'}],formatter:'.isSelected'}" writeToDom="true" />
                                    </customData>
                                    <Text text="{ExistingShipment>DropNumber}"/>
                                    <Text text="{ExistingShipment>Order/SoldTo}"/>
                                    <Link text="{ExistingShipment>Order/ShipToPO}" press="viewOrderDetails"/>
                                    <Text text="{ExistingShipment>Order/OrderType}"/>
                                    <Text text="{ExistingShipment>Order/ShipToName}"/>
                                    <Text text="{ExistingShipment>Order/ShipToAddr/City}"/>
                                    <Text text="{ExistingShipment>Order/Postcode}"/>
                                    <Text text="{ExistingShipment>Order/Volume}"/>
                                    <Text text="{ExistingShipment>Order/Kg}"/>
                                    <Text text="{path:'ExistingShipment>Order/FixedDateTime',formatter:'.formatter.writeDate'}"/>
                                    <Text text="{path:'ExistingShipment>Order/FixedDateTime',formatter:'.formatter.writeTime'}"/>
                                    <Text text="{ExistingShipment>Order/CustRef}"/>
                                    <Text text="{ExistingShipment>Distance}"/>
                                    <Text text="{ExistingShipment>Time}"/>
                                    <Text text="60"/>
                                    <core:Icon src="sap-icon://delete" press="remove"/>
                                </ColumnListItem>
                            </items>-->
                        </Table>
                    </sb:dragDropTable>
                    <Toolbar class="sb-button-toolbar">
                        <Button text="View map" icon="sap-icon://map" type="Transparent" press="viewMap"/>
                        <ToolbarSpacer/>
                        <Button text="Cancel" press="cancel"/>
                        <Button text="Save" type="Emphasized" icon="sap-icon://save" press="save"/>
                        <Button text="Release" type="Emphasized" icon="sap-icon://accept" press="release"/>
                    </Toolbar>
                    <sb:div id="existing-map" class="sapUiSmallMarginTop" visible="false"/>
                </sb:div>
             </sb:div>
        </content>
    </Panel>
</mvc:View>